# 飞书审批打印插件 - 应用配置功能

## 功能概述

已成功实现了飞书应用凭证（App ID 和 App Secret）的配置管理功能，解决了用户提出的"这两个功能还没有开发完成"的问题。

## 实现的功能

### 1. 应用配置管理组件 (`AppSettings.tsx`)

#### 📋 基本配置标签页
- **App ID 输入**：支持格式验证（`cli_xxxxxxxxx`格式）
- **App Secret 输入**：密码输入框，支持长度验证（最少32位）
- **重定向URL配置**：默认为 `http://localhost:3002`
- **表单验证**：实时验证输入格式的正确性
- **保存功能**：配置保存到浏览器localStorage
- **验证功能**：模拟配置验证过程
- **清除功能**：一键清除所有配置

#### 📖 获取指南标签页
- **步骤1：创建应用** - 详细的飞书开放平台应用创建指南
- **步骤2：获取凭证** - App ID和App Secret获取位置说明
- **步骤3：配置权限** - 所需的飞书API权限列表
- **步骤4：配置重定向** - 重定向URL配置说明

#### 📊 当前配置标签页
- **配置状态显示**：实时显示配置是否完整
- **配置详情展示**：显示当前配置的App ID、App Secret（脱敏）和重定向URL
- **配置管理操作**：支持复制配置到剪贴板
- **状态信息**：显示存储位置、使用状态和最后更新时间

### 2. 主应用集成 (`App.tsx`)

#### 🔗 UI集成
- **新增"应用配置"标签页**：在主导航中添加配置入口
- **快捷配置按钮**：在头部添加"应用配置"快捷按钮
- **图标集成**：使用 `ToolOutlined` 图标表示配置功能

#### 🔄 数据流集成
- **配置持久化**：与飞书SDK的配置读取逻辑集成
- **状态管理**：实时反映配置状态变化
- **错误处理**：完善的错误提示和降级方案

### 3. 飞书SDK增强 (`feishu-sdk.ts`)

#### 🔐 配置读取逻辑
- **多源配置支持**：支持从localStorage和环境变量读取配置
- **配置优先级**：localStorage配置 > 环境变量配置 > 默认配置
- **安全访问**：使用安全的方式访问环境变量
- **配置传递**：将配置信息传递给飞书SDK上下文

#### 🛡️ 错误处理
- **配置缺失处理**：当配置不存在时使用模拟数据
- **格式错误处理**：配置格式错误时的降级方案
- **网络错误处理**：SDK加载失败时的备用方案

### 4. 类型定义完善 (`types/index.ts`)

#### 📝 TypeScript接口
- **AppConfig接口**：定义应用配置的数据结构
- **BitableContext增强**：添加可选的appConfig属性
- **类型安全**：确保配置数据的类型安全

## 使用方法

### 1. 访问配置页面
1. 打开应用：http://localhost:3002
2. 点击顶部"应用配置"按钮
3. 或直接点击"应用配置"标签页

### 2. 配置应用凭证
1. 在"基本配置"标签页填写：
   - **App ID**：格式如 `cli_a1b2c3d4e5f6g7h8`
   - **App Secret**：32位字符串密钥
   - **重定向URL**：默认 `http://localhost:3002`
2. 点击"保存配置"按钮
3. 系统会验证配置格式并保存到本地

### 3. 验证配置
1. 切换到"当前配置"标签页
2. 查看配置状态和详情
3. 使用复制功能快速获取配置信息

### 4. 获取应用凭证
如果不清楚如何获取App ID和App Secret，可以：
1. 查看"获取指南"标签页
2. 按照步骤在飞书开放平台创建应用
3. 复制应用凭证到配置页面

## 技术特性

### ✅ 已实现功能
- [x] App ID和App Secret输入表单
- [x] 配置格式验证
- [x] localStorage持久化存储
- [x] 配置读取和写入
- [x] 配置清除功能
- [x] 配置状态显示
- [x] 获取指南文档
- [x] 与飞书SDK集成
- [x] TypeScript类型安全
- [x] 用户友好的UI界面

### 🔒 安全特性
- App Secret使用密码输入框，支持显示/隐藏
- 配置信息仅存储在浏览器本地
- 敏感信息在显示时进行脱敏处理
- 输入验证防止格式错误

### 🎨 用户体验
- 直观的标签页布局
- 实时表单验证
- 友好的错误提示
- 一键复制功能
- 响应式设计

## 配置示例

### 测试配置
```javascript
{
  "appId": "cli_test123456789",
  "appSecret": "test_secret_32_characters_long_123456",
  "redirectUri": "http://localhost:3002"
}
```

### 环境变量配置
```env
VITE_APP_ID=your_app_id_here
VITE_APP_SECRET=your_app_secret_here
```

## 部署说明

1. **本地开发**：配置保存在localStorage，刷新页面后保持
2. **生产部署**：建议使用环境变量配置，提高安全性
3. **飞书集成**：配置完成后，在飞书环境中会自动使用真实SDK

## 后续计划

- [ ] 添加配置导入/导出功能
- [ ] 支持多环境配置切换
- [ ] 添加配置历史记录
- [ ] 集成真实的配置验证API
- [ ] 添加配置备份和恢复功能

---

**功能状态**：✅ 已完成
**测试状态**：✅ 已通过
**用户需求**：✅ 满足用户提出的"App ID和App Secret配置功能开发完成"要求