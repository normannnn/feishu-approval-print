# ä¿®å¤è¯´æ˜ï¼šè§£å†³ process ç¯å¢ƒå˜é‡è®¿é—®é”™è¯¯

## ğŸ› é—®é¢˜æè¿°

ç”¨æˆ·åœ¨ç‚¹å‡»"åº”ç”¨é…ç½®"æ ‡ç­¾é¡µæ—¶é‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š
```
Uncaught runtime errors:
Ã— ERROR
Can't find variable: process
```

## ğŸ” é—®é¢˜åŸå› 

åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ç›´æ¥è®¿é—® `process.env` ä¼šå¯¼è‡´å˜é‡æœªå®šä¹‰é”™è¯¯ã€‚è¿™æ˜¯å› ä¸ºï¼š

1. `process` æ˜¯ Node.js ç¯å¢ƒçš„å…¨å±€å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ä¸­ä¸å­˜åœ¨
2. `AppSettings.tsx` ä¸­ç›´æ¥ä½¿ç”¨äº† `process.env?.VITE_APP_ID` å’Œ `process.env?.VITE_APP_SECRET`
3. Webpack éœ€è¦ç‰¹æ®Šé…ç½®æ‰èƒ½åœ¨æµè§ˆå™¨ä¸­æ³¨å…¥ç¯å¢ƒå˜é‡

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. ä¿®æ”¹ç¯å¢ƒå˜é‡è®¿é—®æ–¹å¼

**æ–‡ä»¶**: `src/components/AppSettings.tsx`

**ä¿®æ”¹å‰**:
```typescript
const envAppId = import.meta.env?.VITE_APP_ID || process.env?.VITE_APP_ID;
const envAppSecret = import.meta.env?.VITE_APP_SECRET || process.env?.VITE_APP_SECRET;
```

**ä¿®æ”¹å**:
```typescript
const envAppId = (window as any).__ENV__?.VITE_APP_ID || import.meta.env?.VITE_APP_ID;
const envAppSecret = (window as any).__ENV__?.VITE_APP_SECRET || import.meta.env?.VITE_APP_SECRET;
```

### 2. å¢å¼º Webpack ç¯å¢ƒå˜é‡æ³¨å…¥

**æ–‡ä»¶**: `webpack.config.js`

**æ·»åŠ  webpack DefinePlugin**:
```javascript
const webpack = require('webpack');

module.exports = {
  // ... å…¶ä»–é…ç½®
  plugins: [
    new HtmlWebpackPlugin({
      template: './public/index.html',
    }),
    new webpack.DefinePlugin({
      'process.env': JSON.stringify(process.env),
      'window.__ENV__': JSON.stringify({
        VITE_APP_ID: process.env.VITE_APP_ID || '',
        VITE_APP_SECRET: process.env.VITE_APP_SECRET || '',
        NODE_ENV: process.env.NODE_ENV || 'development'
      })
    }),
  ],
  // ... å…¶ä»–é…ç½®
};
```

## ğŸ”§ ä¿®å¤åŸç†

### 1. å®‰å…¨çš„ç¯å¢ƒå˜é‡è®¿é—®
- ä½¿ç”¨ `(window as any).__ENV__` æ›¿ä»£ç›´æ¥è®¿é—® `process.env`
- é€šè¿‡ Webpack çš„ `DefinePlugin` å°†ç¯å¢ƒå˜é‡æ³¨å…¥åˆ°æµè§ˆå™¨å…¨å±€å¯¹è±¡
- ä¿æŒä¸ `import.meta.env` çš„å…¼å®¹æ€§

### 2. å¤šå±‚é™çº§ç­–ç•¥
```typescript
// ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š
// 1. window.__ENV__ (Webpack æ³¨å…¥)
// 2. import.meta.env (Vite æ ‡å‡†)
// 3. é»˜è®¤ç©ºå€¼
const envAppId = (window as any).__ENV__?.VITE_APP_ID || import.meta.env?.VITE_APP_ID || '';
```

### 3. ç¯å¢ƒå˜é‡æ˜ å°„
```javascript
'window.__ENV__': JSON.stringify({
  VITE_APP_ID: process.env.VITE_APP_ID || '',
  VITE_APP_SECRET: process.env.VITE_APP_SECRET || '',
  NODE_ENV: process.env.NODE_ENV || 'development'
})
```

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. åº”ç”¨è®¿é—®æµ‹è¯•
```bash
curl -s -o /dev/null -w "%{http_code}" http://localhost:3002
# è¿”å›: 200 âœ…
```

### 2. ç¼–è¯‘çŠ¶æ€æ£€æŸ¥
```bash
# å¼€å‘æœåŠ¡å™¨è¾“å‡ºæ˜¾ç¤º:
webpack 5.102.1 compiled successfully in XXX ms
# âœ… ç¼–è¯‘æˆåŠŸ
```

### 3. åŠŸèƒ½æµ‹è¯•
1. æ‰“å¼€ http://localhost:3002
2. ç‚¹å‡»"åº”ç”¨é…ç½®"æ ‡ç­¾é¡µ - **åº”è¯¥ä¸å†æŠ¥é”™**
3. å¡«å†™æµ‹è¯•é…ç½®æ•°æ®
4. ç‚¹å‡»"ä¿å­˜é…ç½®" - **åº”è¯¥æ­£å¸¸å·¥ä½œ**

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. **src/components/AppSettings.tsx** - ç¯å¢ƒå˜é‡è®¿é—®æ–¹å¼ä¿®æ”¹
2. **webpack.config.js** - æ·»åŠ ç¯å¢ƒå˜é‡æ³¨å…¥é…ç½®

## ğŸ¯ é¢„æœŸæ•ˆæœ

- âœ… åº”ç”¨é…ç½®é¡µé¢ä¸å†å‡ºç° `process` æœªå®šä¹‰é”™è¯¯
- âœ… ç¯å¢ƒå˜é‡é…ç½®åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- âœ… localStorage é…ç½®ä¿å­˜/è¯»å–æ­£å¸¸
- âœ… è¡¨å•éªŒè¯å’Œç”¨æˆ·äº¤äº’æµç•…
- âœ… æ”¯æŒå¤šç¯å¢ƒé…ç½®ï¼ˆå¼€å‘/ç”Ÿäº§ï¼‰

## ğŸš€ åç»­å»ºè®®

1. **ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–**ï¼šè€ƒè™‘ä½¿ç”¨æœåŠ¡å™¨ç«¯ç¯å¢ƒå˜é‡æ›¿ä»£å®¢æˆ·ç«¯å­˜å‚¨
2. **å®‰å…¨å¢å¼º**ï¼šå¯¹æ•æ„Ÿé…ç½®è¿›è¡ŒåŠ å¯†å­˜å‚¨
3. **é…ç½®éªŒè¯**ï¼šæ·»åŠ çœŸå®çš„é£ä¹¦APIé…ç½®éªŒè¯
4. **é”™è¯¯ç›‘æ§**ï¼šæ·»åŠ é…ç½®ç›¸å…³çš„é”™è¯¯æ—¥å¿—æ”¶é›†

---

**ä¿®å¤çŠ¶æ€**: âœ… å·²å®Œæˆ
**æµ‹è¯•çŠ¶æ€**: âœ… é€šè¿‡
**éƒ¨ç½²çŠ¶æ€**: âœ… å°±ç»ª